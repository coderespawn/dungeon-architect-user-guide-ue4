<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <meta name="author" content="for Unreal Engine 4" />
  <title>Dungeon Architect User Guide</title>
  <style type="text/css">code{white-space: pre;}</style>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="../theme/css/bootstrap.min.css">
    <link rel="stylesheet" href="../theme/css/theme.css">
  
    <script src="../theme/js/jquery.min.js"></script>
    <script src="../theme/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
</head>
<body>

<script>

function getPdfUrl() {
	return "../pdf/user_guide_2.7.pdf";
}

</script>

  <link rel="stylesheet" href="../theme/highlight/styles/tomorrow.css">
  <script src="../theme/highlight/highlight.pack.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>

<script>
 $(document).ready(function () {
	 $("#TOC").prependTo("#toc_host");
	 $("#TOC").attr("data-spy", "affix");
	 $("#TOC").attr("data-offset-top", "5");
	$("#TOC").addClass("bs-sidebar");
	$("#TOC").addClass("hidden-print");
	
	 $("#download_pdf").appendTo("#TOC");
	
	 /*
	*/
        var url = window.location.href;
        url = url.replace(window.location.hash, "");

	    // Will only work if string in href matches with location
        $('ul.nav a[href="' + url + '"]').parent().addClass('active');

    // Will also work for relative and absolute hrefs
        $('ul.nav a').filter(function () {
            return this.href == url;
        }).parent().addClass('active').parent().parent().addClass('active');

    });

// Smooth scroll
$(function() {
  $('a[href*=#]:not([href=#])').click(function() {
    if (location.pathname.replace(/^\//,'') == this.pathname.replace(/^\//,'') && location.hostname == this.hostname) {
      var target = $(this.hash);
      target = target.length ? target : $('[name=' + this.hash.slice(1) +']');
      if (target.length) {
        $('html,body').animate({
          scrollTop: target.offset().top
        }, 500);
        return false;
      }
    }
  });
});

</script>

<script>


$( document ).ready(function() {

	$('img.svg').each(function(){
		var $img = jQuery(this);
		var imgID = $img.attr('id');
		var imgClass = $img.attr('class');
		var imgURL = $img.attr('src');

		jQuery.get(imgURL, function(data) {
                // Get the SVG tag, ignore the rest
                var $svg = jQuery(data).find('svg');

                // Add replaced image's ID to the new SVG
                if(typeof imgID !== 'undefined') {
                	$svg = $svg.attr('id', imgID);
                }
                // Add replaced image's classes to the new SVG
                if(typeof imgClass !== 'undefined') {
                	$svg = $svg.attr('class', imgClass+' replaced-svg');
                }

                // Remove any invalid XML tags as per http://validator.w3.org
                $svg = $svg.removeAttr('xmlns:a');

                // Replace image with new SVG
                $img.replaceWith($svg);

            }, 'xml');

	});
});
 </script>

<div id="wrap">

  	<div class="container">
<script>
$(document).ready(function() {
	$('#TOC ul').each(function() {
		$(this).addClass("nav");

	});

	$('#TOC').children('ul').each(function() {
		$(this).addClass("bs-sidenav");
	});

  $('a[href="#TOC"]').each(function() {
    $(this).after($(this).text());
    $(this).remove();
  })


	$('.documentationBlock img').each(function() {

		$(this).addClass("width: 100%");
		$(this).addClass("height:100%");
		$(this).addClass('img-responsive');

	});
	$('body').scrollspy({ target: '#TOC' })

	$('img').on('load', function(e) {
    	$('body').scrollspy('refresh');
    });

});

</script>

<div class="row documentationBlock">
		<div class="col-md-3" id="toc_host">
			<div id="download_pdf"><a href="javascript:document.location.href=getPdfUrl();" target="_blank"><i class="fa fa-file-pdf-o"></i> Download PDF</a></div>
		</div>
		<div class="col-md-9" style="font-family: 'Open Sans', sans-serif;">
<div class="branding-logo">
	<img src="../assets/images/ue4_logo.png">
</div>
			<div class="version-block">
			  <div class="dropdown" style="display: inline">
			    <button class="btn btn-primary dropdown-toggle" type="button" data-toggle="dropdown">Version
			    <span class="caret"></span></button>
			    <ul class="dropdown-menu">
			    				<li><a href="user_guide_2.7.html">2.7</a></li>
				<li><a href="user_guide_2.6.html">2.6</a></li>
				<li><a href="user_guide_2.0.html">2.0</a></li>
				<li><a href="user_guide_1.5.0.html">1.5.0</a></li>
				<li><a href="user_guide_1.4.0.html">1.4.0</a></li>
				<li><a href="user_guide_1.3.0.html">1.3.0</a></li>
			    </ul>
			  </div>
			  <div class="version-number">2.7</div>
			</div>
<div id="header">
<h1 class="title">Dungeon Architect User Guide</h1>
<h2 class="author">for Unreal Engine 4</h2>
</div>
<div id="TOC">
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#installation">Installation</a></li>
<li><a href="#generation-overview">Generation Overview</a><ul>
<li><a href="#layout-generation">Layout Generation</a></li>
<li><a href="#visual-generation">Visual Generation</a></li>
</ul></li>
<li><a href="#dungeon-actor">Dungeon Actor</a><ul>
<li><a href="#properties">Properties</a></li>
</ul></li>
<li><a href="#dungeon-builders">Dungeon Builders</a><ul>
<li><a href="#grid-builder">Grid Builder</a><ul>
<li><a href="#configuration">Configuration</a></li>
</ul></li>
<li><a href="#floor-plan-builder">Floor Plan Builder</a><ul>
<li><a href="#configuration-1">Configuration</a></li>
</ul></li>
<li><a href="#simple-city-builder">Simple City Builder</a><ul>
<li><a href="#configuration-2">Configuration</a></li>
<li><a href="#layout">Layout</a></li>
</ul></li>
<li><a href="#snap-builder">Snap Builder</a><ul>
<li><a href="#layout-1">Layout</a></li>
<li><a href="#configuration-3">Configuration</a></li>
<li><a href="#module-creation">Module Creation</a></li>
<li><a href="#snap-connections">Snap Connections</a></li>
</ul></li>
<li><a href="#isaac-builder">Isaac Builder</a></li>
<li><a href="#custom-grid-builder">Custom Grid Builder</a></li>
<li><a href="#theming">Theming</a></li>
</ul></li>
<li><a href="#theme-overview">Theme Overview</a><ul>
<li><a href="#create-a-theme">Create a Theme</a></li>
</ul></li>
<li><a href="#theme-editor">Theme Editor</a><ul>
<li><a href="#properties-1">Properties</a><ul>
<li><a href="#dungeon-property">Dungeon Property</a></li>
<li><a href="#debug-draw">Debug Draw</a></li>
</ul></li>
</ul></li>
<li><a href="#theme-nodes">Theme Nodes</a><ul>
<li><a href="#marker-nodes">Marker Nodes</a><ul>
<li><a href="#creating-marker-nodes">Creating marker nodes</a></li>
</ul></li>
<li><a href="#visual-nodes">Visual Nodes</a><ul>
<li><a href="#creating-visual-nodes">Creating visual nodes</a></li>
</ul></li>
<li><a href="#marker-emitter-nodes">Marker Emitter Nodes</a><ul>
<li><a href="#creating-marker-emitter-nodes">Creating marker emitter nodes</a></li>
<li><a href="#cycles">Cycles</a></li>
</ul></li>
</ul></li>
<li><a href="#theme-node-properties">Theme Node Properties</a><ul>
<li><a href="#visual-nodes-1">Visual Nodes</a><ul>
<li><a href="#mesh-node">Mesh Node</a></li>
<li><a href="#point-light-node">Point Light Node</a></li>
<li><a href="#spot-light-node">Spot Light Node</a></li>
<li><a href="#particle-node">Particle Node</a></li>
<li><a href="#actor-class-node">Actor Class Node</a></li>
<li><a href="#destructible-mesh-node">Destructible Mesh Node</a></li>
</ul></li>
<li><a href="#marker-node">Marker Node</a></li>
<li><a href="#marker-emitter-node">Marker Emitter Node</a></li>
</ul></li>
<li><a href="#rules">Rules</a><ul>
<li><a href="#selection-rule">Selection Rule</a><ul>
<li><a href="#using-selection-rules">Using Selection Rules</a></li>
<li><a href="#example-1">Example #1</a></li>
<li><a href="#example-2">Example #2</a></li>
<li><a href="#example-3">Example #3</a></li>
</ul></li>
<li><a href="#transform-rule">Transform Rule</a><ul>
<li><a href="#using-transform-rules">Using Transform Rules</a></li>
<li><a href="#example-1-1">Example #1</a></li>
<li><a href="#example-2-1">Example #2</a></li>
<li><a href="#example-3-1">Example #3</a></li>
</ul></li>
</ul></li>
<li><a href="#paint-mode">Paint Mode</a><ul>
<li><a href="#paint-tool">Paint Tool</a></li>
<li><a href="#rectangle-tool">Rectangle Tool</a></li>
<li><a href="#border-tool">Border Tool</a></li>
<li><a href="#manual-painting">Manual Painting</a></li>
</ul></li>
<li><a href="#volumes">Volumes</a><ul>
<li><a href="#platform-volume">Platform Volume</a></li>
<li><a href="#theme-override-volume">Theme Override Volume</a></li>
<li><a href="#negation-volume">Negation Volume</a></li>
<li><a href="#mirror-volume">Mirror Volume</a></li>
</ul></li>
<li><a href="#marker-emitters">Marker Emitters</a><ul>
<li><a href="#creating-a-marker-emitter">Creating a Marker Emitter</a></li>
<li><a href="#theme-preview">Theme Preview</a></li>
<li><a href="#example-1-2">Example #1</a></li>
<li><a href="#example-2-2">Example #2</a></li>
<li><a href="#example-3-2">Example #3</a></li>
</ul></li>
<li><a href="#spatial-constraints">Spatial Constraints</a></li>
<li><a href="#clustered-theming">Clustered Theming</a><ul>
<li><a href="#using-clustered-theming">Using Clustered Theming</a></li>
<li><a href="#height-variations">Height Variations</a></li>
</ul></li>
<li><a href="#query-interface">Query Interface</a><ul>
<li><a href="#access-the-query-interface">Access the Query Interface</a></li>
<li><a href="#grid-query-interface">Grid Query Interface</a><ul>
<li><a href="#get-cells">Get Cells</a></li>
<li><a href="#get-cells-of-type">Get Cells Of Type</a></li>
<li><a href="#get-cell-dimension">Get Cell Dimension</a></li>
<li><a href="#get-path-between-cells">Get Path Between Cells</a></li>
<li><a href="#get-furthest-rooms">Get Furthest Rooms</a></li>
<li><a href="#get-cell-at-location">Get Cell At Location</a></li>
<li><a href="#get-cell-type">Get Cell Type</a></li>
<li><a href="#get-random-cell">Get Random Cell</a></li>
<li><a href="#get-random-cell-of-type">Get Random Cell Of Type</a></li>
<li><a href="#contains-stair-between">Contains Stair Between</a></li>
<li><a href="#contains-door-between">Contains Door Between</a></li>
<li><a href="#get-stair-between">Get Stair Between</a></li>
<li><a href="#get-opening-point-between-adjacent-cells">Get Opening Point Between Adjacent Cells</a></li>
<li><a href="#get-adjacent-cells-on-edge">Get Adjacent Cells On Edge</a></li>
<li><a href="#is-near-marker">Is Near Marker</a></li>
</ul></li>
</ul></li>
<li><a href="#spawn-logic">Spawn Logic</a><ul>
<li><a href="#create-spawn-logic">Create Spawn Logic</a></li>
<li><a href="#define-spawn-logic">Define Spawn Logic</a></li>
</ul></li>
<li><a href="#event-listeners">Event Listeners</a><ul>
<li><a href="#creation">Creation</a></li>
<li><a href="#registration">Registration</a></li>
<li><a href="#event-callbacks">Event Callbacks</a><ul>
<li><a href="#on-pre-dungeon-build">On Pre Dungeon Build</a></li>
<li><a href="#on-dungeon-layout-built">On Dungeon Layout Built</a></li>
<li><a href="#on-markers-emitted">On Markers Emitted</a></li>
<li><a href="#on-post-dungeon-build">On Post Dungeon Build</a></li>
<li><a href="#on-pre-dungeon-destroy">On Pre Dungeon Destroy</a></li>
<li><a href="#on-dungeon-destroyed">On Dungeon Destroyed</a></li>
</ul></li>
</ul></li>
<li><a href="#landscape-transformer">Landscape Transformer</a></li>
<li><a href="#navigation">Navigation</a></li>
<li><a href="#advanced">Advanced</a><ul>
<li><a href="#using-multiple-dungeons">Using Multiple Dungeons</a></li>
<li><a href="#blend-with-existing-art">Blend with existing art</a></li>
</ul></li>
</ul>
</div>
<h1 id="introduction">Introduction</h1>
<p>Dungeon Architect is a plugin for Unreal Engine 4 Editor that helps in streamlining the level creation process. It allows you to quickly create levels procedurally (or manually) by blocking out volumes and having the plugin build the environment automatically around it.</p>
<p><iframe width="853" height="480" src="https://www.youtube.com/embed/4aNgzmibRIs?rel=0&amp;showinfo=0" frameborder="0" allowfullscreen></iframe></p>
<p>This document introduces you to the various features of Dungeon Architect and guides you through the creation of a simple level</p>
<h1 id="installation">Installation</h1>
<p><strong>Marketplace Installation:</strong> Install the plugin from the marketplace using the launcher as usual</p>
<p><strong>Manual Installation:</strong> If you have purchased your copy of Dungeon Architect from Code Respawn, you can download the latest build at any time and install it into your project with the following steps</p>
<ul>
<li>In your game’s root directory, create a folder named Plugins</li>
<li>Copy the DungeonArchitect folder found in this archive under Plugin/4.X/ into your game’s plugin folder (which was created in step 1). For example, in the ShooterGame sample demo, the directory structure should look like this: <img src="../assets/images/install_step1.png" alt="Install Step 1" /></li>
<li>Restart the Unreal Editor (if already open) and verify that Dungeon Architect is enabled by navigating to Window Menu &gt; Plugins. <img src="../assets/images/install_step2.png" alt="Install Step 2" /></li>
<li>Confirm that Dungeon Architect is visible and enabled <img src="../assets/images/install_step3.png" alt="Install Step 3" /></li>
</ul>
<h1 id="generation-overview">Generation Overview</h1>
<p>A dungeon is generated in two phases</p>
<ul>
<li>Layout Generation</li>
<li>Visual Generation</li>
</ul>
<div class="figure">
<img src="../assets/images/da_design.png" alt="Architecture" />
<p class="caption">Architecture</p>
</div>
<h2 id="layout-generation">Layout Generation</h2>
<p>In this phase, only the layout of the dungeon is generated in memory. No meshes or actors are actually spawned.</p>
<div class="figure">
<img src="../assets/images/layout_2d.jpg" alt="Layout of the dungeon in memory" />
<p class="caption">Layout of the dungeon in memory</p>
</div>
<p>Next, the level is populated with invisible points called <strong>Markers</strong> around the generated layout. A <strong>marker</strong> has only a name and a transformation in the 3D space.</p>
<div class="figure">
<img src="../assets/images/marker_system_01.png" alt="Markers populated for a sample room" />
<p class="caption">Markers populated for a sample room</p>
</div>
<p>In the above image, after the layout has been built, the dungeon builder has populated the level with marker points around the layout of the dungeon</p>
<h2 id="visual-generation">Visual Generation</h2>
<p>This phase spawns the actors in your scene. It takes all the marker points inserted in the previous phase and replaces them with actors (meshes, lights, blueprints etc) that you have mapped in your theme files</p>
<div class="figure">
<img src="../assets/images/marker_system_02.png" alt="Actors spawned by a theme mapping" />
<p class="caption">Actors spawned by a theme mapping</p>
</div>
<p>The theming engine is executed for each marker inserted in the Layout generation phase. In the above example, when a <code>Ground</code> marker is encountered, it would look for a <code>Ground</code> marker mapping in your theme file and replace the marker with the meshes you have mapped to it</p>
<div class="figure">
<img src="../assets/images/sample_dungeon.jpg" alt="Result after theme mapping" />
<p class="caption">Result after theme mapping</p>
</div>
<p>The advantage of this data driven theme based approach is that theme files can be swapped to give your dungeon a completly different look. Theme files can also be shared across mulitple projects / teams</p>
<p>Multiple themes can also be used within the same dungeon to create variations</p>
<h1 id="dungeon-actor">Dungeon Actor</h1>
<p>A dungeon actor is used to build your dungeons. Drop a dungeon actor into the scene and reset its transform</p>
<div class="figure">
<img src="../assets/images/dugeon_actor_01.png" alt="Dungeon Actors" />
<p class="caption">Dungeon Actors</p>
</div>
<p>The dungeon actor generate a procedural layout for your dungeon based on the various configuration paramters.<br />
After the layout has been generated, it spawns meshes, lights, blueprints etc, based on the mappings you have defined in the Theme file. This way you can define what meshes needs to be attached to the floors, walls, ceilings, etc</p>
<h2 id="properties">Properties</h2>
<p>The Dungeon actor lets you perform various actions on your procedural dungeon. Select the Dungeon Actor and have a look at the Dungeon category under the details window</p>
<div class="figure">
<img src="../assets/images/dungeon_actor_actions_v2.png" alt="Dungeon Actor Properties" />
<p class="caption">Dungeon Actor Properties</p>
</div>
<p><strong>Build Dungeon:</strong> Builds a procedural dungeon. You need to define atleast one theme before you build</p>
<p><strong>Destroy Dungeon:</strong> Destroys an existing dungeon owned by this actor. If you want to rebuild a dungeon after modifying the theme, there is no need to destroy first and you can directly click build</p>
<p><strong>Randomize Seed:</strong> A convenience function that changes the seed in the configuration. Changing the seed would completly change the layout of your dungeon</p>
<p><strong>Builder Class:</strong> A builder is responsible for creating the layout of your dungeon. It contains the method and techniques to design your dungeon. There are different types of builders available</p>
<ul>
<li>Grid: Create complex dungeons with this builder. It supports height variations, stairs, rooms and corridors</li>
<li>FloorPlan: Creates floor plans for your building interiors</li>
<li>Isaac: Creates dungeon layout similar to the game Binding of Isaac. It also supports decorators to further beautify the layout</li>
<li>Snap: Create your modules (rooms) in separate levels and this builder generates a dungeon with these modules by stitching them together</li>
</ul>
<p><strong>Config:</strong> The configuration category changes based on the structure your select. Hover your mouse pointer over the various fields for more info</p>
<p><strong>Themes:</strong> A theme file lets you design the look and feel of your dungeon. There’s an interactive editor that lets you design your own themes. You need to specify atleast one theme file before you can build your dungeon (quick start guide comes with many pre-created themes to get you started)</p>
<p><strong>Marker Emitters:</strong> Dungeon Architect is designed to be modular and it contains many extension points so you can plugin in your own functionality using Blueprints or C++. Marker Emitters is one such extension point that lets you insert marker points in the scene, which your theme can later pick up replace with actors (like meshes, lights etc)</p>
<h1 id="dungeon-builders">Dungeon Builders</h1>
<p>A Dungeon Builder generates the layout of your dungeon. It contains the method and techniques to design your dungeon. There are multiple builders available and you can also create your own implementation if you wish (in blueprint or C++). This allows Dungeon Architect to be extensible and not restricted to a single dungeon layout technique</p>
<div class="figure">
<img src="../assets/images/da_design_builder.png" alt="Dungeon Builder" />
<p class="caption">Dungeon Builder</p>
</div>
<div class="figure">
<img src="../assets/images/dungeon_grid_builder_overview.png" alt="Select a dungeon builder" />
<p class="caption">Select a dungeon builder</p>
</div>
<p>Here we explore the various dungeon builders that ship with Dungeon Architect</p>
<h2 id="grid-builder">Grid Builder</h2>
<p>This builder creates complex and beautiful dungeons with rooms, cooridors and height variations.</p>
<p>This is the default builder used by Dungeon Architect</p>
<p><iframe width="853" height="480" src="https://www.youtube.com/embed/dbDak6J61zw?rel=0&amp;showinfo=0" frameborder="0" allowfullscreen></iframe></p>
<p><img src="../assets/images/paint_rect_04.jpg" alt="Grid Builder layout" /> <img src="../assets/images/grid_builder_eg_1.jpg" alt="Grid Builder layout" /> <img src="../assets/images/grid_builder_eg_2.jpg" alt="Grid Builder layout" /> <img src="../assets/images/grid_builder_eg_3.jpg" alt="Grid Builder layout" /> <img src="../assets/images/grid_builder_eg_4.jpg" alt="Grid Builder layout" /> <img src="../assets/images/grid_builder_eg_5.jpg" alt="Grid Builder layout" /></p>
<h3 id="configuration">Configuration</h3>
<p>Select the Dungeon Actor from the Details window</p>
<div class="figure">
<img src="../assets/images/dungeon_config_grid.png" alt="Dungeon Config Parameters" />
<p class="caption">Dungeon Config Parameters</p>
</div>
<p>The various config parameters determine how the layout of the dungeon is generated procedurally. The default layout generator algorithm is implemented based on the excellent <a href="http://www.reddit.com/r/gamedev/comments/1dlwc4/procedural_dungeon_generation_algorithm_explained/">writeup</a> by TinyKeep’s author Phi Dinh</p>
<p>The various parameters are:</p>
<ul>
<li><strong>Seed</strong>: Changing this number would completely change the layout of the dungeon. This is the base random number seed that is used to build the dungeon</li>
<li><strong>Num Cells</strong>: The number of cells to use while building the dungeon. You will not see these cells in the final result. A larger number would create a bigger and more complex dungeon. A number of 100-150 builds a medium to large sized dungeon. Experiment with different ranges</li>
<li><strong>Min/Max Cell Size</strong>: This is how big or small a cell size can be. While generation, a cell is either converted to a room, corridor or is discarded completely. The Cell width / height is randomly chosen within this range</li>
<li><strong>Room Area Threshold</strong>: If a cell size exceeds past this limit, it is converted into a room. After cells are promoted to rooms, all rooms are connected to each other through corridors (either directly or indirectly. See spanning tree later)</li>
<li><strong>Room Aspect Delta</strong>: The aspect ratio of the cells (width to height ratio). Keeping this value near 0 would create square rooms. Bringing this close to 1 would create elongated / stretched rooms with a high width to height ratio</li>
<li><strong>Spanning Tree Loop</strong>: Determines how many loops you would like to have in your dungeon. A value near 0 will create fewer loops creating linear dungeons. A value near 1 would create lots of loops, which would look unoriginal. Its good to allow a few loops so a value close to zero (like 0.2 should be good)</li>
<li><strong>Stair Connection Tolerance</strong>: The generator would add stairs to make different areas of the dungeon accessible. However, we do not want too many stairs. For e.g., before adding a stair in a particular elevated area, the generator would check if this area is already accessible from a nearby stair. If so, it would not add it. This tolerance parameter determines how far to look for an existing path before we can add a stair. Play with this parameter if you see too many stairs close to each other, or too few</li>
<li><strong>Door Proximity Steps</strong>: Increase this value to remove nearby duplicate doors. This value determines how many cell we can move to reach the two connected cells of a door if the door was removed</li>
<li><strong>Height Variation Probability</strong>: Tweak this value to increase / reduce the height variations (and stairs) in your dungeon. A value close to 0 reduces the height variation and increases as you approach 1. Increasing this value to a higher level might create dungeons with no place for proper stair placement since there is too much height variation. A value of 0.2 to 0.4 seems good</li>
<li><strong>Normal Mean / Std</strong>: The random number generator used in the dungeon generator does not use a uniform distribution. Instead it uses a normal distribution to get higher frequency of lower values and fewer higher values (and hence fewer room cells and a lot more corridor cells). Play with these parameters for different results</li>
<li><strong>Grid Cell Size</strong>: The dungeon generator works on a grid based system and required modular mesh assets to be placed on each cell (floors, walls, doors etc). This important field specifies the size of the cell to use. This size is determined by the art asset used in the dungeon theme designed by the artist. In the demo, we have a floor mesh that is 400x400. The height of a floor is chosen to be 200 units as the stair mesh is 200 units high. Hence the defaults are set to 400x400x200. You should change this to the dimension of the modular asset your designer has created for the dungeon</li>
<li><strong>Max Allowed Stair Height</strong>: The number of logical floor units the dungeon height can vary. This determines how high the dungeon’s height can vary (e.g. max 2 floors high). Set this value depending on the stair meshes you designer has created. In the sample demo, there are two stair meshes, one 200 units high (1 floor) and another 400 units high (2 floors). So the default is set to 2</li>
<li><strong>Initial Room Radius</strong>: Internal Usage. Keep to a low value like 10-15</li>
<li><strong>Floor Height</strong>: Internal Usage. Ignored for now</li>
<li><strong>Instanced</strong>: Use mesh instancing for lower batch count</li>
<li><strong>Max Build Time Per Frame</strong>: The dungeon can be built over multiple frames so as to not hang the game (or the editor UI) while it is being built. This value determines how much time is spent on each frame to build the dungeon. Setting it to 0 would build the entire dungeon synchronously in a single frame. Settting to 33ms for eg, would build it over multiple frames. You get a callback notification when the dungeon build is complete</li>
</ul>
<h2 id="floor-plan-builder">Floor Plan Builder</h2>
<p>Create floor plans for your indoor buildings. This builder is a work in progress</p>
<p><iframe width="853" height="480" src="https://www.youtube.com/embed/K_iQH4TiVS0?rel=0&amp;showinfo=0" frameborder="0" allowfullscreen></iframe></p>
<p><img src="../assets/images/floor_builder_eg_1.jpg" alt="Floor Plan Builder" /> <img src="../assets/images/floor_builder_eg_2.jpg" alt="Floor Plan Builder" /> <img src="../assets/images/floor_builder_eg_3.jpg" alt="Floor Plan Builder" /> <img src="../assets/images/floor_builder_eg_4.jpg" alt="Floor Plan Builder" /> <img src="../assets/images/floor_builder_eg_5.jpg" alt="Floor Plan Builder" /></p>
<h3 id="configuration-1">Configuration</h3>
<p>Select the Dungeon Actor from the Details window</p>
<div class="figure">
<img src="../assets/images/dungeon_config_floor.png" alt="Dungeon Config Parameters" />
<p class="caption">Dungeon Config Parameters</p>
</div>
<ul>
<li><p><strong>Seed</strong>: Changing this number would completely change the layout of the dungeon. This is the base random number seed that is used to build the dungeon</p></li>
<li><p><strong>Building Size</strong>: This is the building size in logical “Grid” units. (see grid size below). Adjust this to change the size of your floor</p></li>
<li><p><strong>Grid Size</strong>: The size of a tile in the floor map. The floor map is created in a tiled grid. Adjust the size here based on your art assets defined in the theme file</p></li>
<li><p><strong>Min/Max Size</strong>: The minimum / maximum size of the room, in logical grid cooridnates</p></li>
<li><p><strong>Hall Width</strong>: Every room is directly or indirectly connected to a hallway. This parameter controls the size of the hallway in grid coordinate</p></li>
<li><p><strong>Min Room Chunk Area</strong>: Rooms are groups together with other rooms. However, they may be split with a hallway in between them if the combined area is greater than this value</p></li>
<li><p><strong>Instanced</strong>: Use mesh instancing for lower batch count</p></li>
<li><p><strong>Max Build Time Per Frame</strong>: The dungeon can be built over multiple frames so as to not hang the game (or the editor UI) while it is being built. This value determines how much time is spent on each frame to build the dungeon. Setting it to 0 would build the entire dungeon synchronously in a single frame. Settting to 33ms for eg, would build it over multiple frames. You get a callback notification when the dungeon build is complete</p></li>
</ul>
<h2 id="simple-city-builder">Simple City Builder</h2>
<p>Create simple city layouts using this builder. This builder is a work in progress</p>
<p>Check the quick start samples for examples</p>
<div class="figure">
<img src="../assets/images/city_builder_toon_city.jpg" alt="City Builder" />
<p class="caption">City Builder</p>
</div>
<p>There’s a simple game that uses the city builder. The cities are procedurally generated using Dungeon Architect. In this game, Dungeon architect also spawns waypoints for the pedestrians to walk around the city</p>
<div class="figure">
<img src="../assets/images/city_builder_zombie_city.png" alt="Zombie City Game Demo" />
<p class="caption">Zombie City Game Demo</p>
</div>
<p><iframe width="853" height="480" src="https://www.youtube.com/embed/ybZuP8ikTsE?rel=0&amp;showinfo=0" frameborder="0" allowfullscreen></iframe></p>
<h3 id="configuration-2">Configuration</h3>
<ul>
<li><strong>CellSize</strong>: Defines the cell size of your city. This depends on your modular art asset used by the roads tiles and buildings</li>
<li><strong>MinCitySize</strong>: The minimum size of the city (in cell units)</li>
<li><strong>MaxCitySize</strong>: The maximum size of the city (in cell units)</li>
<li><strong>MinBlockSize</strong>: The minimum size of a city block (in cell units)</li>
<li><strong>MaxBlockSize</strong>: The maximum size of a city block (in cell units)</li>
<li><strong>BiggerHouseProbability</strong>: The house tiles are not restricted to 1x1 cell size. You can have larger dimension structures (e.g. stadiums, parking lots etc) that take up larger sizes e.g. 3x5, 2x4. This probabiliy defines how often that happens.</li>
<li><strong>RoadEdgeRemovalProbability</strong>: Some of the road edges are removed to create a more uneven and natural look rather than a rectangular grid like structure (refer city image above)</li>
<li><strong>CityBlockDimensions</strong>: Specify larger structured blocks here with their dimension (e.g. 2x3) and their marker name (e.g. <code>ParkingLot</code>). You would then create a marker with this name and attach your larger mesh to it</li>
</ul>
<h3 id="layout">Layout</h3>
<p>Houses inaccessible to roads are promoted to <code>Park</code>. Houses also automatically face the roads. If your house mesh is not facing the road, try rotating it from the mesh node in the theme graph</p>
<h2 id="snap-builder">Snap Builder</h2>
<p>The snap builder allows you to stitch together custom designed rooms. This gives the artist full control on how an individual room looks like. These rooms are called Snap Modules.</p>
<p>Snap Modules are connected together through connection points called Snap Connections. Your modules will have various connection points (usually at the doors)</p>
<p>Check the quick start guide with a demo map with 20+ unique rooms</p>
<p>This builder is a work in progress and is not recommended for use in production yet</p>
<p><iframe width="853" height="480" src="https://www.youtube.com/embed/pKeHsHekjpE?rel=0&amp;showinfo=0" frameborder="0" allowfullscreen></iframe></p>
<h3 id="layout-1">Layout</h3>
<p>A simple layout is used for now where there is a linear path from start to end and a few side branches along the way. In the later updates, there will be multiple implementations of the layout algorithms and you should be able to swap between them</p>
<h3 id="configuration-3">Configuration</h3>
<div class="figure">
<img src="../assets/images/dungeon_config_snap_v2.png" alt="Snap Dungeon Configuration" />
<p class="caption">Snap Dungeon Configuration</p>
</div>
<ul>
<li><p><strong>Seed</strong>: Changing this number would completely change the layout of the dungeon. This is the base random number seed that is used to build the dungeon</p></li>
<li><p><strong>Modules</strong>: Here is where you register your room module assets. DA would use these modules as building blocks to build your dungeon</p></li>
<li><p><strong>Start Modules</strong>: If specified, a module from this list would be used as the starting room <em>[Not used for now]</em></p></li>
<li><p><strong>End Modules</strong>: If specified, a module from this list would be used as the ending room <em>[Not used for now]</em></p></li>
<li><p><strong>Branch End Modules</strong>: If specified, a module from this list would be used as the branch end room <em>[Not used for now]</em></p></li>
<li><p><strong>Main Branch Size</strong>: The size of the main branch from start to end (in module count)</p></li>
<li><p><strong>Collision Test Contraction</strong>: When the modules are stitched together, DA makes sure that the newly spawned module would not overlap with any of the existing spawned module. Setting this value to 0 would not spawn a module in locations with even the slightest overlap. Setting to 100 units for e.g., would tolerate an overlap of 100 Unreal units</p></li>
<li><p><strong>Instanced</strong>: Use mesh instancing for lower batch count <em>[Not used for now]</em></p></li>
<li><p><strong>Max Build Time Per Frame</strong>: The dungeon can be built over multiple frames so as to not hang the game (or the editor UI) while it is being built. This value determines how much time is spent on each frame to build the dungeon. Setting it to 0 would build the entire dungeon synchronously in a single frame. Settting to 33ms for eg, would build it over multiple frames. You get a callback notification when the dungeon build is complete</p></li>
</ul>
<h3 id="module-creation">Module Creation</h3>
<p>Any normal actor blueprint can be used as a snap module. Since it is difficult to design the module inside the blueprint viewport, it is easier to create your room module in a separate level then convert it to a blueprint</p>
<h3 id="snap-connections">Snap Connections</h3>
<p>You modules need a way to connect to other modules. This is done using Snap Connections. Create a new snap connection blueprint by choosing SnapConnection as the base class</p>
<div class="figure">
<img src="../assets/images/snap_connection.png" alt="Snap Connection" />
<p class="caption">Snap Connection</p>
</div>
<p>Drop this snap connection blueprints in your module blueprint and position them accordingly.</p>
<p>This is an experimental feature and will change in the future</p>
<h2 id="isaac-builder">Isaac Builder</h2>
<p>Generates levels similar to the game Binding of Isaac. This builder is a work in progress</p>
<p><iframe width="853" height="480" src="https://www.youtube.com/embed/eRrh-SLcJ0A?rel=0&amp;showinfo=0" frameborder="0" allowfullscreen></iframe></p>
<h2 id="custom-grid-builder">Custom Grid Builder</h2>
<p>This is based on the Grid Builder and allows you to define your own layouts easily from blueprints. It has various high level functions for placement of rooms and their corridor connections. If you are looking to define your own procedural layouts in blueprints, you might want to start here</p>
<p>Check the quick start samples for more info <iframe width="853" height="480" src="https://www.youtube.com/embed/AzO2gI0NV-Q?rel=0&amp;showinfo=0" frameborder="0" allowfullscreen></iframe></p>
<h2 id="theming">Theming</h2>
<p>To preview your custom builder in a theme file, open the theme in the Theme Editor and go to Properties &gt; Dungeon</p>
<div class="figure">
<img src="../assets/images/cave_builder_d.png" alt="Preview Dungeon Properties" />
<p class="caption">Preview Dungeon Properties</p>
</div>
<p>Assign your builder to the <strong>Builder Class</strong> property and the preview viewport should use your builder to build the preview dungeon</p>
<div class="figure">
<img src="../assets/images/cave_builder_f.png" alt="Builder Class" />
<p class="caption">Builder Class</p>
</div>
<h1 id="theme-overview">Theme Overview</h1>
<p>A theme file lets you design the look and feel of you dungeons with an intuitive graph based approach</p>
<p>Themes are saved as a separate assets in the Content Browser. It also has an interactive editor to help you design beautiful levels</p>
<div class="figure">
<img src="../assets/images/theme_file_example.jpg" alt="An example theme" />
<p class="caption">An example theme</p>
</div>
<div class="figure">
<img src="../assets/images/da_design_themes.png" alt="Themes are used by the Theming Engine" />
<p class="caption">Themes are used by the Theming Engine</p>
</div>
<h2 id="create-a-theme">Create a Theme</h2>
<p>To create a new theme, right click in the content browser and choose “Dungeon Theme”</p>
<div class="figure">
<img src="../assets/images/create_dungeon_theme_menu.png" alt="Create a dungeon theme" />
<p class="caption">Create a dungeon theme</p>
</div>
<h1 id="theme-editor">Theme Editor</h1>
<p>Double click a dungeon theme asset to open it in the <code>Theme Editor</code></p>
<div class="figure">
<img src="../assets/images/theme_file_asset.png" alt="A theme asset file" />
<p class="caption">A theme asset file</p>
</div>
<div class="figure">
<img src="../assets/images/theme_editor_empty.png" alt="Dungeon Architect Theme Editor" />
<p class="caption">Dungeon Architect Theme Editor</p>
</div>
<h2 id="properties-1">Properties</h2>
<p>The Theme editor exposes various properties that lets you customize the 3D viewport</p>
<div class="figure">
<img src="../assets/images/theme_editor_properties.png" alt="Theme Editor Viewport Properties" />
<p class="caption">Theme Editor Viewport Properties</p>
</div>
<h3 id="dungeon-property">Dungeon Property</h3>
<p>An important property is <strong>Dungeon</strong>. Choose Dungeon from the list and the Details window will show the properties of the Dungeon actor used in the 3D viewport.</p>
<div class="figure">
<img src="../assets/images/theme_editor_properties_2.png" alt="Theme Editor Dungeon Properties" />
<p class="caption">Theme Editor Dungeon Properties</p>
</div>
<p>Make sure you update the <strong>Grid Cell Size</strong> variable to match the dimensions of your modular assets so that the preview window can show them correctly</p>
<h3 id="debug-draw">Debug Draw</h3>
<p>Turn on the Debug Drawer to align the ground mesh with the layout. Sometimes the pivot of your ground mesh might not be in the center and you need to make sure it aligns properly with the layout so that it works nicely with other markers (Walls, Fence etc)</p>
<p>This example shows the ground mesh not aligned properly because the pivot of the mesh is in the corner of the mesh and is clearly visible when <strong>Debug Draw</strong> is turn on</p>
<div class="figure">
<img src="../assets/images/theme_editor_properties_3.jpg" alt="Improper alignment of ground mesh" />
<p class="caption">Improper alignment of ground mesh</p>
</div>
<p>A simple adjustment in the Offset variable of the ground mesh node aligns it properly</p>
<div class="figure">
<img src="../assets/images/theme_editor_properties_4.jpg" alt="Properly aligned with the ground mesh" />
<p class="caption">Properly aligned with the ground mesh</p>
</div>
<h1 id="theme-nodes">Theme Nodes</h1>
<p>A Theme can have 3 category of nodes</p>
<ul>
<li><strong>Marker Nodes</strong></li>
<li><strong>Visual Nodes</strong></li>
<li><strong>Marker Emitter Nodes</strong></li>
</ul>
<div class="figure">
<img src="../assets/images/node_categories.jpg" alt="Theme Node categories" />
<p class="caption">Theme Node categories</p>
</div>
<h2 id="marker-nodes">Marker Nodes</h2>
<p>After the layout generation phase, the scene would be scattered with invisible named points called <strong>Markers</strong>. Then, for every marker point in the scene, the theming engine looks for a corresponding <strong>Marker Node</strong> with that marker name. If found, it would start executing all the nodes defined below the marker node.</p>
<p>For e.g., if you have a marker node named <code>Ground</code>, it would be invoked for every <code>Ground</code> marker found in the scene. Once invoked, the theming engine executes all the nodes defined below it from left to right untill a certain condition is met</p>
<div class="figure">
<img src="../assets/images/marker_nodes_01.png" alt="Ground Marker Node" />
<p class="caption">Ground Marker Node</p>
</div>
<p>In the above example:</p>
<ol style="list-style-type: decimal">
<li>In the first phase, the layout builder has populated the map with ground markers, wherever a ground mesh was expected.<br />
</li>
<li>Then in the next phase, the theming engine ecounters the <code>Ground</code> marker while iterating through all the markers in the scene</li>
<li>It then looks for a <strong>Marker Node</strong> named <code>Ground</code> in the theme graph</li>
<li>Once found, it executes the visual nodes defined below it, starting from left to right</li>
</ol>
<p>When you create a new theme asset, the theme graph comes with a set of default marker nodes.</p>
<p>You can define new marker nodes and build your own hierarcy for advanced theming</p>
<p>Names of custom marker nodes can be changed by double clicking on them, or from the details tab</p>
<h3 id="creating-marker-nodes">Creating marker nodes</h3>
<p>There are several ways to create a new marker node:</p>
<p>Right click anywhere in the empty area and expand the <code>Dungeon</code> category and click <strong>Add Marker Node</strong> <img src="../assets/images/marker_create_01.png" alt="Add new marker node from Context Menu" /></p>
<p>Alternatively, these context menu actions are also visible in the Actions tab. Drag and drop the <strong>Add Marker Node</strong> action into any empty area in the graph <img src="../assets/images/marker_create_02.png" alt="Add new marker node from Actions Tab" /></p>
<h2 id="visual-nodes">Visual Nodes</h2>
<p>Visual nodes are used for spawning actors into the scene (e.g. meshes, lights, particle systems, blueprints etc). They are usually attached to a marker node and executed whenever an marker with that name is encountered in the scene. When executed, it spawns an actor defined within it and places it in the scene where the marker was encountered</p>
<p>You can create the following visual nodes:</p>
<ul>
<li><strong>Mesh Node</strong> - Good for spawning static meshes.</li>
<li><strong>Point Light Node</strong> - Spawns point lights anywhere in your dungeon</li>
<li><strong>Spot Light Node</strong> - Spawns spot lights</li>
<li><strong>Particle Node</strong> - Spawns particle systems</li>
<li><strong>Actor Node</strong> - Spawn any type of actor by specifying it’s class</li>
<li><strong>Breakable Mesh Node</strong> - Spawns destructible meshes</li>
</ul>
<p>If you have the Dungeon Architect Paper2D extension installed, then you can spawn additional visual nodes</p>
<ul>
<li><strong>Paper Sprite Node</strong> - Good for spawning individual sprites</li>
<li><strong>Paper Flipbook Node</strong> - Spawn animated sprites</li>
<li><strong>Paper Tile Node</strong> - Spawn tiles extracted from a Paper2D tilemap. The editor gives you a user-friendly UI to select the tile from the tilemap</li>
</ul>
<h3 id="creating-visual-nodes">Creating visual nodes</h3>
<p>There are several ways to create a new visual node:</p>
<p>Drag a link out of the marker node you intend to attach it on and select the appropriate visual node you desire <img src="../assets/images/create_visual_node_01.png" alt="Drag a link from existing marker nodes" /></p>
<div class="figure">
<img src="../assets/images/create_visual_node_02.png" alt="Choose a Visual Node from the filtered list" />
<p class="caption">Choose a Visual Node from the filtered list</p>
</div>
<p>Alternatively, right click anywhere in the empty area and expand the <code>Dungeon</code> category and choose a visual node to create</p>
<div class="figure">
<img src="../assets/images/create_visual_node_03.png" alt="Choose a Visual Node from the context menu" />
<p class="caption">Choose a Visual Node from the context menu</p>
</div>
<p>Alternatively, these context menu actions are also visible in the Actions tab. Drag and drop visual node action into any empty area in the graph <img src="../assets/images/create_visual_node_04.png" alt="Add new visual node from Actions Tab" /></p>
<h2 id="marker-emitter-nodes">Marker Emitter Nodes</h2>
<p>Marker Emitters emit new markers into the scene. These nodes are attached to visual nodes and if the parent visual node is executed, it would insert a named marker into the scene.</p>
<p><strong>Marker Emitter</strong> nodes are similar in apperarance to Marker Nodes. However, they are purple in color and have an input pin, instead of an output pin</p>
<div class="figure">
<img src="../assets/images/theme_file_example2.jpg" alt="Sample theme file" />
<p class="caption">Sample theme file</p>
</div>
<p>In the above example, the <code>Wall</code> Marker has 3 Mesh nodes attached to it with probability such that any one for the 3 would be randomly chosen.<br />
One of the 3 meshes has a window in it and we would like to decorate that mesh with curtains, but only if that node is selected. So, we define a new Marker named <code>Window</code> (can be any name) and attach curtain meshes to it. Then we <strong>emit</strong> a Window Marker Node from the desired visual node. Hence, if the mesh in the middle is executed, it would also insert a marker named <em>Window</em> in its position. Then the theming engine would execute everything beneath the <code>Window</code> marker and pick a random curtain and attach to the wall</p>
<p>This ability of defining your own hierarchy lets you design powerful themes for your levels</p>
<h3 id="creating-marker-emitter-nodes">Creating marker emitter nodes</h3>
<p>To create a <strong>Marker Emitter</strong> Node, drag a link out of a visual node and select a marker name you would like to emit</p>
<div class="figure">
<img src="../assets/images/create_marker_emitter_01.png" alt="Choose a Marker to emit from the filtered context menu" />
<p class="caption">Choose a Marker to emit from the filtered context menu</p>
</div>
<p>Alternatively, right click anywhere in the empty area and expand the <code>Marker Emitters</code> category and click choose a marker to emit</p>
<div class="figure">
<img src="../assets/images/create_marker_emitter_02.png" alt="Choose a Marker to emit from the context menu" />
<p class="caption">Choose a Marker to emit from the context menu</p>
</div>
<p>Alternatively, these context menu actions are also visible in the Actions tab. Drag and drop visual node action into any empty area in the graph</p>
<div class="figure">
<img src="../assets/images/create_marker_emitter_03.png" alt="Choose a Marker to emit from the Actions tab" />
<p class="caption">Choose a Marker to emit from the Actions tab</p>
</div>
<h3 id="cycles">Cycles</h3>
<p>Cycles are not allowed when you emit markers as it doesn’t make sense to continuously emit markers in an infinite loop</p>
<p>The editor takes care of not allowing cycles and notifies you with a user-friendly message when you attempt to create a connection with a marker emitter that might cause a loop</p>
<div class="figure">
<img src="../assets/images/marker_node_cycle.jpg" alt="Cycles not allowed" />
<p class="caption">Cycles not allowed</p>
</div>
<h1 id="theme-node-properties">Theme Node Properties</h1>
<p>A node in the theme graph can be customized from the Details Tab</p>
<h2 id="visual-nodes-1">Visual Nodes</h2>
<p>Select a visual node (e.g. a mesh node) and have a look at the details tab:</p>
<div class="figure">
<img src="../assets/images/mesh_node_properties_a.png" alt="Mesh Node properties" />
<p class="caption">Mesh Node properties</p>
</div>
<p>The properties that are common to all Visual nodes (Mesh, Blueprints, Lights, Particle, Sprite etc) are explained below:</p>
<p><strong>Affinity:</strong> This is the probability of attachment. When this node is executed, the theming engine looks at this variable and rolls a dice and decides whether to insert this visual object into the scene or not. If this value is 1.0, then it would insert it 100% of the time. If the value is 0, then it would not insert it since selection probabiliyt 0%. If it is 0.5, then it would insert it 50% of the time</p>
<p><strong>Consume on Attach:</strong> If the visual object was indeed spawned into the scene (based on the probability above), the theming engine would then look at this flag to decide if we need to execute the next sibling node. If it is checked, then execution stops for this marker. If it is unchecked, the next sibling gets processed. <em>Affinity</em> and <em>Consume on Attach</em> can be combined to create interesting possiblities in your theme</p>
<p><strong>Offset:</strong> Apply transformation offset to your visual object relative to the marker location. This is a very useful property while designing your theme. If the pivot of the mesh your artist has designed isn’t where you wish it were, you can easily adjust it here to translate / rotate it around. You can also scale objects if they are too small / big. While designing your theme, you might be using this useful property to re-position your visual nodes, if required.</p>
<p><strong>Selection Logic:</strong> Lets you define selection logic blueprints. You have seen an example above of node selected based on random probability (Affinity property). The selection process can be far more power than a simple random probability based selection. You can define you own blueprints and assign it here so you blueprint logic could decide if a node is to be selected or not. More details below</p>
<p><strong>Transform Logic:</strong> In the Offset property as seen above, you can define a static offset transformation to move/scale/rotate the visual object from the marker position. With Transform Logic, you can define blueprint based transformation where you can provide dynamic tranform offsets based on a logic. For e.g., you might want to rotate/scale/translate a tree randomly to give natural variation instead of having them all face the same direction. More on this later</p>
<h3 id="mesh-node">Mesh Node</h3>
<p>A mesh not lets you place static meshes on the scene</p>
<div class="figure">
<img src="../assets/images/node_prop_mesh.png" alt="Mesh Node properties" />
<p class="caption">Mesh Node properties</p>
</div>
<p><strong>Mesh:</strong> Specify the static mesh you would like to use here</p>
<p><strong>Material Overrides</strong>: Optionally override the material of a mesh. Index property lets you set the sub-mesh index. Multiple material overrides can be assigned</p>
<div class="figure">
<img src="../assets/images/node_prop_mesh2.png" alt="Mesh Node Advanced properties" />
<p class="caption">Mesh Node Advanced properties</p>
</div>
<p><strong>Advanced properties</strong>: Modify advanced mesh node properties from here. Note: The <em>material overrides</em> and <em>static mesh</em> parameter has to be set in the node’s property as described above and not here</p>
<p>TIP: Drag a static mesh from the content browser on to the graph window to quickly create a mesh node</p>
<div class="figure">
<img src="../assets/images/theme_editor_drag_drop.png" alt="Drag Drop static mesh to create a mesh node" />
<p class="caption">Drag Drop static mesh to create a mesh node</p>
</div>
<h3 id="point-light-node">Point Light Node</h3>
<p>Place point lights on the scene with this node</p>
<div class="figure">
<img src="../assets/images/node_prop_pointlight.png" alt="Point Light Node Properties" />
<p class="caption">Point Light Node Properties</p>
</div>
<p>Adjust light properties (intensity, shadow, color etc) from the <strong>Point Light</strong> field</p>
<h3 id="spot-light-node">Spot Light Node</h3>
<p>Place spot lights on the scene with this node</p>
<div class="figure">
<img src="../assets/images/node_prop_spotlight.png" alt="Spot Light Node Properties" />
<p class="caption">Spot Light Node Properties</p>
</div>
<p>Adjust light properties (intensity, shadow, color etc) from the <strong>Point Light</strong> field</p>
<p>Spot lights in the preview window show an arrow indicating the direction the spot light is pointing to</p>
<h3 id="particle-node">Particle Node</h3>
<p>Place particle emitters on the scene with this node</p>
<div class="figure">
<img src="../assets/images/node_prop_particle.jpg" alt="Particle Emitter Node Properties" />
<p class="caption">Particle Emitter Node Properties</p>
</div>
<p>Assign the Paritcle system template in the <strong>Particle System</strong> field</p>
<p>You can drag and drop a particle system from the content browser on to the theme editor to create a new particle system node</p>
<div class="figure">
<img src="../assets/images/drag_drop_particle_node.png" alt="Particle Node Drag Drop" />
<p class="caption">Particle Node Drag Drop</p>
</div>
<h3 id="actor-class-node">Actor Class Node</h3>
<p>You can place any kind of actor in the scene using an <strong>Actor Node</strong></p>
<div class="figure">
<img src="../assets/images/node_prop_actor1.png" alt="Actor Node Properties" />
<p class="caption">Actor Node Properties</p>
</div>
<p>Set the class of the actor you would like to spawn in the <strong>Class Template</strong> field</p>
<div class="figure">
<img src="../assets/images/node_prop_actor2.png" alt="Actor Node spawning a Reflection Capture Actor" />
<p class="caption">Actor Node spawning a Reflection Capture Actor</p>
</div>
<p>After you have set a class, you can modify and customize your actor properties. This allows you to set your actor’s public blueprint variables</p>
<div class="figure">
<img src="../assets/images/actor_node_customize.png" alt="Actor Node spawning a Reflection Capture Actor" />
<p class="caption">Actor Node spawning a Reflection Capture Actor</p>
</div>
<h3 id="destructible-mesh-node">Destructible Mesh Node</h3>
<div class="figure">
<img src="../assets/images/destruct_mesh_wall.jpg" alt="Destructible Mesh" />
<p class="caption">Destructible Mesh</p>
</div>
<p>Spawn destructible meshes on your scene using this node. Destructible meshes are a feature in UE4 that lets you fracture a mesh when it is damaged. You can find more info on creating destructible meshes <a href="https://docs.unrealengine.com/latest/INT/Videos/PLZlv_N0_O1gYeJX3xX44yzOb7_kTS7FPM/-gGiEmYj4oE/">here</a></p>
<p>After you have created a destructible mesh, you can assign it to this node from the details window</p>
<div class="figure">
<img src="../assets/images/destruct_mesh_details.png" alt="Destructible Mesh Details" />
<p class="caption">Destructible Mesh Details</p>
</div>
<p>The Deathmatch shooter demo uses destructible meshes. The players can shoot at it and break the walls</p>
<p><iframe width="853" height="480" src="https://www.youtube.com/embed/VZIIEQoMp7o?rel=0&amp;showinfo=0" frameborder="0" allowfullscreen></iframe></p>
<h2 id="marker-node">Marker Node</h2>
<div class="figure">
<img src="../assets/images/node_prop_marker.png" alt="Marker Node Properties" />
<p class="caption">Marker Node Properties</p>
</div>
<p>You can change the name of a marker node by setting it’s <strong>Marker Name</strong> field</p>
<h2 id="marker-emitter-node">Marker Emitter Node</h2>
<div class="figure">
<img src="../assets/images/node_prop_marker_emitter.png" alt="Marker Emitter Node Properties" />
<p class="caption">Marker Emitter Node Properties</p>
</div>
<p>When you emit a marker, you can apply an offset to the emitted marker in the <strong>Offset</strong> field</p>
<h1 id="rules">Rules</h1>
<p>You can attach Blueprint (or C++) based logic on the theme nodes for more control. There are two types of rules you can attach to Visual nodes</p>
<div class="figure">
<img src="../assets/images/rules_01.png" alt="Visual Node Rules" />
<p class="caption">Visual Node Rules</p>
</div>
<h2 id="selection-rule">Selection Rule</h2>
<p>A selection rule is a blueprint class (or C++ class) that is used to decide if the current node is to be attached to the scene. This rule replaces the default <strong>Affinity</strong> property that is used for randomly deciding if visual node needs spawning based on a probability.</p>
<p>Selection rules gives you more power, when you need it. In the rule’s blueprint logic, you can query the dungeon model and determin if this node should be inserted into the scene</p>
<h3 id="using-selection-rules">Using Selection Rules</h3>
<p>To assing an existing rule into the node, Check the <strong>Use Selection Logic</strong> property and select the rule you would like to attach to the node from the dropdown list</p>
<div class="figure">
<img src="../assets/images/selection_rule_01a.png" alt="Assign an existing Selection Rule" />
<p class="caption">Assign an existing Selection Rule</p>
</div>
<p>Create a new selection rule by creating a new blueprint class derived from the appropriate DungeonSelectorLogic. It should match the builder you are targeting</p>
<div class="figure">
<img src="../assets/images/create_rule_transform1.png" alt="Create a new Selection Rule" />
<p class="caption">Create a new Selection Rule</p>
</div>
<p>Open up the blueprint and override the <strong>Select Node</strong> function. This function will be called by the engine and the logic you put here will let you decide if the node should to be selected</p>
<div class="figure">
<img src="../assets/images/selection_rule_04.png" alt="Override function to define logic" />
<p class="caption">Override function to define logic</p>
</div>
<p>The selection can be combined with the Affinity varaible by unchecking <strong>Logic Overrides Affinity</strong></p>
<div class="figure">
<img src="../assets/images/selection_rule_02b.png" alt="Combine selection logic with Affinity variable" />
<p class="caption">Combine selection logic with Affinity variable</p>
</div>
<h3 id="example-1">Example #1</h3>
<p>Here is an example of a selection logic that selects a node only if the sum of their X and Y positions are even numbers (logic for a checkerboard pattern)</p>
<div class="figure">
<img src="../assets/images/selection_rule_05.png" alt="Override function to define logic" />
<p class="caption">Override function to define logic</p>
</div>
<p>And the result after applying this rule to the ground node:</p>
<div class="figure">
<img src="../assets/images/selection_rule_06.jpg" alt="Custom selection rule attached to a mesh node" />
<p class="caption">Custom selection rule attached to a mesh node</p>
</div>
<p>You can add more visual nodes and experiment with the <strong>Consume on Attach</strong> parameter to get interesting results</p>
<div class="figure">
<img src="../assets/images/selection_rule_07.jpg" alt="Multiple visual nodes working together" />
<p class="caption">Multiple visual nodes working together</p>
</div>
<p>In the above example, the first node has <strong>Consume on Attach</strong> checked. So if your blueprint logic selects the node, the sandstone mesh will be inserted and the execution stops. However if the selection node doesn’t select the node, the execution will always proceed to the next node and execute the mesh which inserts a clay brick mesh</p>
<p><img src="../assets/images/selection_rule_eg1_1.jpg" /> In the above example, the selection rule is applied to the golden pillar. But whenever it is selected, it stops execution because the <strong>Consume on Attach</strong> variable is set and doesn’t build a ground mesh there. Unchecking <strong>Consume on Attach</strong> on the first node lets the execution proceed even if it is inserted into the scene <img src="../assets/images/selection_rule_eg1_2.jpg" /></p>
<h3 id="example-2">Example #2</h3>
<p>This example places a stone mesh on the ground, but only if the cell is inside a room (and not a corridor)</p>
<div class="figure">
<img src="../assets/images/selection_rule_eg2_1.jpg" alt="Stone ground mesh selection only when inside rooms" />
<p class="caption">Stone ground mesh selection only when inside rooms</p>
</div>
<div class="figure">
<img src="../assets/images/selection_rule_eg2_2.jpg" alt="Room selector logic" />
<p class="caption">Room selector logic</p>
</div>
<p>The above Selection logic was attached to the stone mesh ground node so it gets selected only when the ground marker is inside a room</p>
<h3 id="example-3">Example #3</h3>
<p>Ignore nodes that are near other markers. This is very useful if you don’t want to place blocking items near stairs, doors etc</p>
<p><img src="../assets/images/query_grid_near_marker_1.png" alt="Query System" /> <img src="../assets/images/query_grid_near_marker_2.png" alt="Query System" /></p>
<h2 id="transform-rule">Transform Rule</h2>
<p>Dungeon Architect lets you specify offsets to your visual nodes to move/scale/rotate them from their relative marker locations.</p>
<div class="figure">
<img src="../assets/images/offset.png" alt="Static node Offset" />
<p class="caption">Static node Offset</p>
</div>
<p>However, if you want a more dynamic way of applying offsets (based on blueprint or C++ logic), you can do so with a <em>Transform Rule</em>. This can be very useful to add variations to your levels for certain props</p>
<h3 id="using-transform-rules">Using Transform Rules</h3>
<p>To assing an existing rule into the node, Check the <strong>Use Transform Logic</strong> property and select the rule you would like to attach to the node from the dropdown list</p>
<div class="figure">
<img src="../assets/images/transform_rule_01b.png" alt="Assign an existing Transform Rule" />
<p class="caption">Assign an existing Transform Rule</p>
</div>
<p>Create a new Transform rule by creating a new blueprint class derived from the appropriate DungeonTransformLogic. It should match the builder you are targeting</p>
<div class="figure">
<img src="../assets/images/transform_rule_01a.png" alt="Create a new Selection Rule" />
<p class="caption">Create a new Selection Rule</p>
</div>
<p>Open up the blueprint and override the <strong>Get Node Offset</strong> function. This function will be called by the engine and the logic you put here will let you decide on the offset that needs to be applied on this node</p>
<div class="figure">
<img src="../assets/images/transform_rule_04.png" alt="Override function to define logic" />
<p class="caption">Override function to define logic</p>
</div>
<h3 id="example-1-1">Example #1</h3>
<p>In this example, a single rock mesh is randomly rotated, and slightly scaled and translated to give a nice cave like look</p>
<div class="figure">
<img src="../assets/images/transform_rule_eg1_1.jpg" alt="Rocks randomly rotated, translated and scaled" />
<p class="caption">Rocks randomly rotated, translated and scaled</p>
</div>
<p>A different transformation rule is applied to ceiling stone meshes for more variations</p>
<div class="figure">
<img src="../assets/images/transform_rule_eg1_2.jpg" alt="Transform rule applied to rock nodes" />
<p class="caption">Transform rule applied to rock nodes</p>
</div>
<div class="figure">
<img src="../assets/images/transform_rule_eg1_3.png" alt="Cliff Random rotation rule" />
<p class="caption">Cliff Random rotation rule</p>
</div>
<h3 id="example-2-1">Example #2</h3>
<p>Here is an example where alternate pipes are rotated by 180 degrees to give a visually appealing look</p>
<div class="figure">
<img src="../assets/images/transform_rule_eg2_1.jpg" alt="Alternate meshes are rotated by 180 degrees" />
<p class="caption">Alternate meshes are rotated by 180 degrees</p>
</div>
<p>This was done by rotating the mesh node by 180 degrees for every alternate cell (similar to the checker rule logic seen previously)</p>
<div class="figure">
<img src="../assets/images/transform_rule_eg2_2.jpg" alt="Rule assignment" />
<p class="caption">Rule assignment</p>
</div>
<h3 id="example-3-1">Example #3</h3>
<p>In this example a small random rotation is applied to orange ground tiles. Useful while creating ruins when laying down broken tile meshes</p>
<div class="figure">
<img src="../assets/images/vol_platform_04c.jpg" alt="Transform rule applied to orange ground meshes" />
<p class="caption">Transform rule applied to orange ground meshes</p>
</div>
<div class="figure">
<img src="../assets/images/transform_rule_eg3_1.png" alt="Transformation Rule Blueprint" />
<p class="caption">Transformation Rule Blueprint</p>
</div>
<h1 id="paint-mode">Paint Mode</h1>
<p>Dungeon Architect also allows you to paint your own dungeon layouts with a special editor mode. This gives you more artistic control as you are no longer restricted by what the procedural algorithm creates</p>
<p>To Activate the Paint Editor mode and start painting, Switch to the <em>Dungeon Paint</em> Tab</p>
<div class="figure">
<img src="../assets/images/paint_em_01.png" alt="Dungeon Paint Editor Mode" />
<p class="caption">Dungeon Paint Editor Mode</p>
</div>
<p>As soon as you switch to the Paint Mode, the viewport shows the layout of your dungeon in Blue</p>
<p><img src="../assets/images/paint_01.jpg" /> <img src="../assets/images/paint_02.jpg" alt="Dungeon Paint Editor Mode" /></p>
<p>There are various tools you could use to paint your dungeons</p>
<div class="figure">
<img src="../assets/images/paint_tools.png" alt="Paint tools" />
<p class="caption">Paint tools</p>
</div>
<h2 id="paint-tool">Paint Tool</h2>
<p>The paint tool allows you to paint at different heights. Custom painted blocks are Cyan in color</p>
<p>Paint by holding <em>Left click</em></p>
<p>Delete a painted block by <em>Shift + Left Click</em></p>
<p><img src="../assets/images/paint_03.jpg" /> <img src="../assets/images/paint_04.jpg" /></p>
<p>You can adjust the size of the paint brush and change the logical floor height you would like to paint on</p>
<div class="figure">
<img src="../assets/images/paint_tool_1.png" alt="Paint Brush Configuration" />
<p class="caption">Paint Brush Configuration</p>
</div>
<h2 id="rectangle-tool">Rectangle Tool</h2>
<p>The rectangle tool lets you cover larger areas. Hold and drag to draw a rectangle. Release to commit the changes. Custom painted blocks are Cyan in color</p>
<p>Paint by holding <em>Left click</em></p>
<p>Delete a painted block by <em>Shift + Left Click</em></p>
<p><img src="../assets/images/paint_rect_01.jpg" /> <img src="../assets/images/paint_rect_02.jpg" /> <img src="../assets/images/paint_rect_03.jpg" /> <img src="../assets/images/paint_rect_04.jpg" /></p>
<h2 id="border-tool">Border Tool</h2>
<p>The border tool works similar to the Rectangle tool, paints along the border of the rectangle layed down by the user.</p>
<p>Hold and drag to draw a rectangle. Release to commit the changes. Custom painted blocks are Cyan in color</p>
<p>The thickness of the border can be adjusted with the Brush Size property</p>
<p>You can paint in different height by changing the <em>Floor Index</em> property</p>
<div class="figure">
<img src="../assets/images/paint_tool_1.png" />

</div>
<p>Paint by holding <em>Left click</em></p>
<p>Delete a painted block by <em>Shift + Left Click</em></p>
<p><img src="../assets/images/paint_border_01.jpg" /> <img src="../assets/images/paint_border_02.jpg" /> <img src="../assets/images/paint_border_03.jpg" /> <img src="../assets/images/paint_border_04.jpg" /></p>
<h2 id="manual-painting">Manual Painting</h2>
<p>If you do not want any procedural content to be generated when you paint your level, then set the <strong>Num Cells</strong> property to <code>0</code> in your Dungeon Actor’s Configuration section</p>
<div class="figure">
<img src="../assets/images/num_cells_0.png" alt="Stop procedural layout generation" />
<p class="caption">Stop procedural layout generation</p>
</div>
<p>This way the dungeon would have an empty layout, allowing you to paint from scratch</p>
<p>If you do want procedural content but want to remove certain procedural areas that are getting in your way, then use a <em>Negation Volume</em></p>
<h1 id="volumes">Volumes</h1>
<p>Dungeon Architect provides various volumes to help you influence your dungeon as per your requirements.</p>
<h2 id="platform-volume">Platform Volume</h2>
<p>Place a platform volume anywhere in the scene and Dungeon Architect would adjust the dungeon layout and create a platform (room or corridor) at that location. Scale the volume along the XY plane to change the size of the generated platform. You can move the platform volume with the move tool to the desired location. (Rotation is not supported)</p>
<p>This gives you artistic control and lets you manipulate the dungeon to suit your needs</p>
<p>Here is an example of a user generated layout using volumes leading up to a boss fight</p>
<div class="figure">
<img src="../assets/images/vol_platform_01.jpg" alt="User defined dungeon layout" />
<p class="caption">User defined dungeon layout</p>
</div>
<p>To place a platform volume, go to Volumes tab and drag and drop it into the scene</p>
<div class="figure">
<img src="../assets/images/vol_platform_02.jpg" alt="Place a platform volume into the scene" />
<p class="caption">Place a platform volume into the scene</p>
</div>
<p>Select the platform volume and have a look at it’s properties</p>
<div class="figure">
<img src="../assets/images/vol_platform_03.jpg" alt="Platform Volume Properties" />
<p class="caption">Platform Volume Properties</p>
</div>
<p>The Volume needs to know which dungeon the volume belongs to (DA Supports mulitple dungeons within the same scene). Select the dungeon you have in your scene.</p>
<p>Relatime Update flag updates the dungeon as you move/scale the platform volume, giving you interactive feedback. Uncheck if you face performance issues (Or, build the dungeon over multiple frames without stalling the UI by setting the Dungeon actor config propery’s field <em>MaxBuildTimePerFrameMs</em> to around 20 to 30)</p>
<p>An example of a corridor segment created using a platform volume. Notice how the platform nicely blends with the existing geometry if it comes in contact with it</p>
<p><img src="../assets/images/vol_platform_04a.jpg" alt="Platform Volume Example" /> <img src="../assets/images/vol_platform_04b.jpg" alt="Platform Volume Example" /> <img src="../assets/images/vol_platform_04c.jpg" alt="Platform Volume Example" /> <img src="../assets/images/vol_platform_04d.jpg" alt="Platform Volume Example" /></p>
<p>Rooms always connect to atleast one other room in the dungeon. Changing the Cell type to <em>Room</em> creates this result</p>
<div class="figure">
<img src="../assets/images/vol_platform_05.jpg" alt="Room creation using a Platform Volume" />
<p class="caption">Room creation using a Platform Volume</p>
</div>
<h2 id="theme-override-volume">Theme Override Volume</h2>
<p>Give certain areas of you dungeons a different look and feel. Layout inside this volume would use the theme defined by this volume.</p>
<p>This is useful for adding variations to your level</p>
<div class="figure">
<img src="../assets/images/vol_theme_01.jpg" alt="Hell Forge Theme" />
<p class="caption">Hell Forge Theme</p>
</div>
<div class="figure">
<img src="../assets/images/vol_theme_02.jpg" alt="A different theme applied to this section" />
<p class="caption">A different theme applied to this section</p>
</div>
<div class="figure">
<img src="../assets/images/vol_theme_03.jpg" alt="Layout within the volume picks up the theme overridden by the volume" />
<p class="caption">Layout within the volume picks up the theme overridden by the volume</p>
</div>
<div class="figure">
<img src="../assets/images/vol_theme_04.png" alt="Theme Override Volume Properties" />
<p class="caption">Theme Override Volume Properties</p>
</div>
<p>The <strong>Reversed</strong> flag, if checked, overrides the theme of everything outside of the volume (as opposed to inside)</p>
<p><strong>Realtime Update</strong> updates the dungeon as it is moved or scaled giving your immediate visual feedback</p>
<p>Note: When overriding, the themes needs to be designed for the same grid cell size for proper results</p>
<h2 id="negation-volume">Negation Volume</h2>
<p>This volume removes all procedural geometry inside of this volume. Use this to get rid of procedural geometry in areas you do not need or when it is getting in the way while manually painting your layout</p>
<p><img src="../assets/images/vol_negation_01.jpg" alt="Theme Override Volume Properties" /> <img src="../assets/images/vol_negation_02.jpg" alt="Theme Override Volume Properties" /></p>
<div class="figure">
<img src="../assets/images/create_volume_negation.png" alt="Drag and drop a Negation Volume" />
<p class="caption">Drag and drop a Negation Volume</p>
</div>
<div class="figure">
<img src="../assets/images/vol_negation_properties.png" alt="Negation Volume Properties" />
<p class="caption">Negation Volume Properties</p>
</div>
<p>The <strong>Reversed</strong> flag, if checked, removes all the procedural layout outside of the volume (as opposed to inside)</p>
<p><strong>Realtime Update</strong> updates the dungeon as it is moved or scaled giving your immediate visual feedback</p>
<h2 id="mirror-volume">Mirror Volume</h2>
<p>Mirror Volumes lets you create symmetric dungeon by mirroring the layout of a dungeon</p>
<div class="figure">
<img src="../assets/images/vol_mirror_01.jpg" alt="Dungeon Mirrored along the X-axis" />
<p class="caption">Dungeon Mirrored along the X-axis</p>
</div>
<div class="figure">
<img src="../assets/images/vol_mirror_02.jpg" alt="Dungeon Mirrored along both the X and Y-axis" />
<p class="caption">Dungeon Mirrored along both the X and Y-axis</p>
</div>
<p>This is useful when you need symmetry in your maps (e.g. strategy games)</p>
<p>To create a Mirror Volume, drag it from the volumes tab:</p>
<div class="figure">
<img src="../assets/images/vol_mirror_03.jpg" alt="Drag and drop a Mirror volume from the Volumes tab" />
<p class="caption">Drag and drop a Mirror volume from the Volumes tab</p>
</div>
<p>Place the volume where you would like to have the layout mirrored. The mirroring would happen along the local X-axis of the volume. You can rotate the volume in steps of 90 degrees (0, 90, 180, 270) to mirror in different directions</p>
<p>Multiple mirrors can also be placed within the same dungeon</p>
<p>Example of procedural maps created for a 2-player twin stick RTS game <img src="../assets/images/vol_mirror_eg_1.jpg" /> <img src="../assets/images/vol_mirror_eg_2.jpg" /> <img src="../assets/images/vol_mirror_eg_3.jpg" /> <img src="../assets/images/vol_mirror_eg_4.jpg" /> <img src="../assets/images/vol_mirror_eg_5.jpg" /></p>
<h1 id="marker-emitters">Marker Emitters</h1>
<p>Marker Emitters are blueprint scripts (or C++) that lets you emit your own markers anywhere in the map</p>
<div class="figure">
<img src="../assets/images/da_design_me.png" alt="Architecture" />
<p class="caption">Architecture</p>
</div>
<p>As seen previously, <em>Markers</em> are emitted by the Dungeon Builder class around the layout of the dungeon (e.g. Wall, Ground, Fence etc) and you can insert actors at that location from the Theme graph. You can even create your own markers emitted off of those parent markers, but without <em>Marker Emitters</em> you are restricted to the starting markers the dungeon builder has initially emitted for you</p>
<p>Marker Emitters gives you a lot of flexibility and you can query the dungeon model and emit markers anywhere in the map</p>
<p>A Marker Emitter is invoked right after the Dungeon Builder emits all the markers for the dungeon (Ground, Wall etc)</p>
<h2 id="creating-a-marker-emitter">Creating a Marker Emitter</h2>
<p>Create a new Blueprint class derived from DungeonMarkerEmitter <img src="../assets/images/create_marker_emiter_dialog.png" alt="Create a new marker emitter" /></p>
<p>Assign the created blueprint marker emitter to the Dungeon Actor</p>
<div class="figure">
<img src="../assets/images/assign_marker_emitter.png" alt="Assign to the Dungeon actor" />
<p class="caption">Assign to the Dungeon actor</p>
</div>
<p>Start placing your logic in the blueprint by overriding the <strong>Emit Markers</strong> function</p>
<div class="figure">
<img src="../assets/images/marker_emitter_04.png" alt="Override the EmitMarkers function" />
<p class="caption">Override the EmitMarkers function</p>
</div>
<p>This method is invoked by the engine and lets you emit as many markers as you like into the scene with any transforms.</p>
<p>To emit a marker, create a <em>Emit Marker</em> node</p>
<div class="figure">
<img src="../assets/images/marker_emitter_05.png" alt="Emit Marker Node" />
<p class="caption">Emit Marker Node</p>
</div>
<p>You can emit as many markers as you like</p>
<h2 id="theme-preview">Theme Preview</h2>
<p>If you want to preview your marker emitter logic in the Theme Editor’s 3D Preview viewport, you can set it up like this:</p>
<p>Navigate to the theme editor’s 3D Viewport &gt; Properties &gt; Dungeon</p>
<div class="figure">
<img src="../assets/images/marker_emitter_te_1.png" alt="Theme Editor’s 3D Viewport &gt; Properties &gt; Dungeon" />
<p class="caption">Theme Editor’s 3D Viewport &gt; Properties &gt; Dungeon</p>
</div>
<p>This will open up the dungeon properties. Add your marker emitter there and the preview viewport will pick up the markers emitted by your Marker Emitter blueprint script and show it in the preview viewport</p>
<div class="figure">
<img src="../assets/images/marker_emitter_te_2.jpg" alt="Theme Editor’s 3D Viewport &gt; Properties &gt; Dungeon" />
<p class="caption">Theme Editor’s 3D Viewport &gt; Properties &gt; Dungeon</p>
</div>
<h2 id="example-1-2">Example #1</h2>
<p>This marker emitter queries the dungeon model and emits a marker at the center of all the rooms</p>
<div class="figure">
<img src="../assets/images/marker_emitter_eg1_1.png" alt="Sample Marker Emitter" />
<p class="caption">Sample Marker Emitter</p>
</div>
<div class="figure">
<img src="../assets/images/marker_emitter_eg1_2.png" alt="Marker Emitted with this name" />
<p class="caption">Marker Emitted with this name</p>
</div>
<div class="figure">
<img src="../assets/images/marker_emitter_eg1_3.png" alt="Create a Marker node with the same name" />
<p class="caption">Create a Marker node with the same name</p>
</div>
<div class="figure">
<img src="../assets/images/marker_emitter_eg1_4.png" alt="Theming engine picks it up and inserts it in the middle of the room" />
<p class="caption">Theming engine picks it up and inserts it in the middle of the room</p>
</div>
<h2 id="example-2-2">Example #2</h2>
<p>The <em>Hell Forge</em> demo has a good looking cave like system generated using Marker Emitters.</p>
<p>Since the rocks for the cave walls cannot be inserted in the Wall and Fence markers (as they are big and would block the passage), we need to find positions in the empty space that are further away from the walls and fences</p>
<p>This is done with a marker emitter blueprint <code>DA_InfinityBlade_Fire/Dungeons/Rules/MarkerEmitter/BPM_AdjacentCellEmitter</code></p>
<div class="figure">
<img src="../assets/images/marker_emitter_eg2_1.png" alt="Visualizing the emitter with different colored cubes" />
<p class="caption">Visualizing the emitter with different colored cubes</p>
</div>
<div class="figure">
<img src="../assets/images/marker_emitter_eg2_2.jpg" alt="Visualizing the emitter with different colored cubes" />
<p class="caption">Visualizing the emitter with different colored cubes</p>
</div>
<p>The Hell Forge theme applies rocks to these markers (EmptySpaceN) and increases their scale as they move further away from the the ground</p>
<div class="figure">
<img src="../assets/images/marker_emitter_eg2_3.jpg" alt="Theme to create Mountains using a Marker Emitter" />
<p class="caption">Theme to create Mountains using a Marker Emitter</p>
</div>
<p>This gives a nice progressive elevation to the mountains giving the impression that the pathways are naturally formed</p>
<div class="figure">
<img src="../assets/images/marker_emitter_eg2_4.jpg" alt="Hell Forge theme with Mountains and Caves" />
<p class="caption">Hell Forge theme with Mountains and Caves</p>
</div>
<h2 id="example-3-2">Example #3</h2>
<p>Heres another example of a curved roof created over a room using marker emitters</p>
<p><img src="../assets/images/marker_emitter_eg3_1.jpg" /> <img src="../assets/images/marker_emitter_eg3_2.jpg" /> <img src="../assets/images/marker_emitter_eg3_3.jpg" /></p>
<h1 id="spatial-constraints">Spatial Constraints</h1>
<p>Spatial constraints are great of checking the state of nearby tiles and using it as a condition to place items on the scene</p>
<p>Spatial constraints are set in the theme graph’s node.</p>
<div class="figure">
<img src="../assets/images/spatial_constraint_a.jpg" alt="Spatial Constraints" />
<p class="caption">Spatial Constraints</p>
</div>
<p>In the above example, a statue mesh is added to the ground marker. We want this to appear only on the corners and not on each tile</p>
<p>Select a mesh node and in the details panel, enable <em>Use Spatial Constraint</em></p>
<p>Then select the spatial constraint type. Since this is a ground mesh, it is surrounded by 3x3 tiles</p>
<div class="figure">
<img src="../assets/images/spatial_constraint2.png" alt="Spatial Constraints" />
<p class="caption">Spatial Constraints</p>
</div>
<p>Expand the spatial setup. Here you specify the rules of the adjacent tiles, whether it should be empty, occupied or should be ignored. The rules will try to rotate to best fit the layout</p>
<div class="figure">
<img src="../assets/images/spatial_constraint3.jpg" alt="Spatial Constraints" />
<p class="caption">Spatial Constraints</p>
</div>
<p>With this setup, the statues spawn only at the corners</p>
<h1 id="clustered-theming">Clustered Theming</h1>
<p>Clustered theming allows you to automatically apply different themes to various parts (clusters) of your dungeons. This helps in adding variation to your levels and break monotony</p>
<p>A continous section of corridor cells or rooms are assigned to a clusters to have a proper theme transtions</p>
<div class="figure">
<img src="../assets/images/cluster_theme.jpg" alt="Cluster Theming" />
<p class="caption">Cluster Theming</p>
</div>
<h2 id="using-clustered-theming">Using Clustered Theming</h2>
<p>To use clustered theming, enable it from the dungeon’s detail panel</p>
<div class="figure">
<img src="../assets/images/cluster_theme_enable.png" alt="Enable Cluster Theming" />
<p class="caption">Enable Cluster Theming</p>
</div>
<p>Once enabled, you need to define a list of theme sets you’d like to apply on the clusters from the Advanced category of the dungeon’s detail panel</p>
<div class="figure">
<img src="../assets/images/cluster_theme_advanced_details.png" alt="Assign Cluster Themes" />
<p class="caption">Assign Cluster Themes</p>
</div>
<p><strong>IMPORTANT:</strong> When you use clustered themes, the <strong>dungeon’s default theme array list will be ignored</strong> and the theme list defined in the cluster themes mapping would be used instead</p>
<p>Currently, only the grid builder supports clustered theming</p>
<h2 id="height-variations">Height Variations</h2>
<p>Corridor cells connected together are grouped into a cluster. You can customize if connected nearby corridor cells on different height (connected through stairs) should be grouped into the same cluster</p>
<div class="figure">
<img src="../assets/images/cluster_theme_advanced_details.png" alt="Cluster Height Variation" />
<p class="caption">Cluster Height Variation</p>
</div>
<p><img src="../assets/images/cluster_theme_height1.jpg" alt="Cluster Height Variation" /> <img src="../assets/images/cluster_theme_height2.jpg" alt="Cluster Height Variation" /></p>
<p>Notice the corridor on the bottom right. It was split into two themes because of the height variation</p>
<h1 id="query-interface">Query Interface</h1>
<p>The query interface has various helper functions to query the structure of the dungeon. You can use the query interface in your selector / transform logics or marker emitters for more control</p>
<p>Each builder implements its own query interface.</p>
<h2 id="access-the-query-interface">Access the Query Interface</h2>
<p>You can access the query interface from different places</p>
<div class="figure">
<img src="../assets/images/query_interface_access_selector_logic.png" alt="Query interface in the selection rule" />
<p class="caption">Query interface in the selection rule</p>
</div>
<hr />
<div class="figure">
<img src="../assets/images/query_interface_access_transform_logic.png" alt="Query interface in the transformer rule" />
<p class="caption">Query interface in the transformer rule</p>
</div>
<hr />
<div class="figure">
<img src="../assets/images/query_interface_access_marker_emiter.png" alt="Query interface in the marker emitter" />
<p class="caption">Query interface in the marker emitter</p>
</div>
<hr />
<div class="figure">
<img src="../assets/images/query_interface_access_dungeon_actor.png" alt="Query interface from other blueprints" />
<p class="caption">Query interface from other blueprints</p>
</div>
<hr />
<h2 id="grid-query-interface">Grid Query Interface</h2>
<p>The Grid Query Interface lets you query the structure of a grid builder based dungeon</p>
<h3 id="get-cells">Get Cells</h3>
<p>Gets a list of all the Cell IDs in the dungeon. A corridor patch or a room is a cell. A cell is always rectangular in shape, with a center and size</p>
<div class="figure">
<img src="../assets/images/query_grid_GetCells.png" alt="Get Cells" />
<p class="caption">Get Cells</p>
</div>
<h3 id="get-cells-of-type">Get Cells Of Type</h3>
<p>Similar to Get Cells function but filters the cells based on a type (Room, Coordor)</p>
<div class="figure">
<img src="../assets/images/query_grid_GetCellsOfType.png" alt="Get Cells Of Type" />
<p class="caption">Get Cells Of Type</p>
</div>
<h3 id="get-cell-dimension">Get Cell Dimension</h3>
<p>Gets the dimension of a cell. This takes in a cell id and will return the center and the size of the cell</p>
<div class="figure">
<img src="../assets/images/query_grid_GetCellDimension.png" alt="Get Cell Dimension" />
<p class="caption">Get Cell Dimension</p>
</div>
<h3 id="get-path-between-cells">Get Path Between Cells</h3>
<p>Gets a valid path between any two cell points. This can be used to create waypoints in your game. There is an example in the quick start guide demonstrating this</p>
<div class="figure">
<img src="../assets/images/query_grid_GetPathBetweenCells.png" alt="Get Path Between Cells" />
<p class="caption">Get Path Between Cells</p>
</div>
<div class="figure">
<img src="../assets/images/query_grid_path.jpg" alt="Query path between two cells" />
<p class="caption">Query path between two cells</p>
</div>
<h3 id="get-furthest-rooms">Get Furthest Rooms</h3>
<p>Find the furthest rooms in the dungeon. This function returns two cell ID. This can be useful for setting the start / end rooms (or spawn / boss rooms)</p>
<div class="figure">
<img src="../assets/images/query_grid_GetFurthestRooms.png" alt="Get Furthest Rooms" />
<p class="caption">Get Furthest Rooms</p>
</div>
<h3 id="get-cell-at-location">Get Cell At Location</h3>
<p>Pass in a world location and get the cell id. This is useful for finding the cell an actor is in. For e.g., if you’d like to check if all NPCs in a room are dead before unlocking a door, you would iterate through all the actors and check if they are in the same room the player is in</p>
<div class="figure">
<img src="../assets/images/query_grid_GetCellAtLocation.png" alt="Get Cell At Location" />
<p class="caption">Get Cell At Location</p>
</div>
<h3 id="get-cell-type">Get Cell Type</h3>
<p>Find the type of the cell (Room, corridor). There is another category called CorridorPadding, which should also be considered a Corridor</p>
<div class="figure">
<img src="../assets/images/query_grid_GetCellType.png" alt="Get Cell Type" />
<p class="caption">Get Cell Type</p>
</div>
<h3 id="get-random-cell">Get Random Cell</h3>
<p>Gets a random cell from the dungeon.</p>
<p>There also a version that takes in a random stream. You should use the random stream version if you want to guarantee the same dungeon for a particular configuration. The dungeon’s random stream is access from within the selector and transform rules</p>
<div class="figure">
<img src="../assets/images/query_grid_GetRandomCell.png" alt="Get Random Cell" />
<p class="caption">Get Random Cell</p>
</div>
<h3 id="get-random-cell-of-type">Get Random Cell Of Type</h3>
<p>Gets a random cell of a particular type from the dungeon.</p>
<p>There also a version that takes in a random stream. You should use the random stream version if you want to guarantee the same dungeon for a particular configuration. The dungeon’s random stream is access from within the selector and transform rules</p>
<div class="figure">
<img src="../assets/images/query_grid_GetRandomCellOfType.png" alt="Get Random Cell Of Type" />
<p class="caption">Get Random Cell Of Type</p>
</div>
<h3 id="contains-stair-between">Contains Stair Between</h3>
<p>Check if there is a stair connecting the two input cells</p>
<div class="figure">
<img src="../assets/images/query_grid_ContainsStairBetween.png" alt="Contains Stair Between" />
<p class="caption">Contains Stair Between</p>
</div>
<h3 id="contains-door-between">Contains Door Between</h3>
<p>Check if there is a door connecting the two input cells</p>
<div class="figure">
<img src="../assets/images/query_grid_ContainsDoorBetween.png" alt="Contains Door Between" />
<p class="caption">Contains Door Between</p>
</div>
<h3 id="get-stair-between">Get Stair Between</h3>
<p>Get the stair information between the two input cells</p>
<div class="figure">
<img src="../assets/images/query_grid_GetStairBetween.png" alt="Get Stair Between" />
<p class="caption">Get Stair Between</p>
</div>
<h3 id="get-opening-point-between-adjacent-cells">Get Opening Point Between Adjacent Cells</h3>
<p>When two cells are adjacent to each other, there might be a constraint on how we can traverse through them. There might be a height variation, or there might be a wall between the cells. In that case, the only valid way to move across is through the stair or a door repectively. This function calculates and returns the correct world position. This position lies in the edge of the two cells. If there is no barrier between the two cells (doors / stairs) a point in the center of the edge is returned</p>
<div class="figure">
<img src="../assets/images/query_grid_GetOpeningPointBetweenAdjacentCells.png" alt="Get Opening Point Between Adjacent Cells" />
<p class="caption">Get Opening Point Between Adjacent Cells</p>
</div>
<p>This function is used in the path demo to correctly place the spline through the doors and stairs</p>
<div class="figure">
<img src="../assets/images/query_grid_path.jpg" alt="Query path between two cells" />
<p class="caption">Query path between two cells</p>
</div>
<h3 id="get-adjacent-cells-on-edge">Get Adjacent Cells On Edge</h3>
<div class="figure">
<img src="../assets/images/query_grid_GetAdjacentCellsOnEdge.png" alt="Get Adjacent Cells On Edge" />
<p class="caption">Get Adjacent Cells On Edge</p>
</div>
<p>You can use this function in a selector logic of a marker that is on the edge (e.g. Walls / Fence). This function returns the cells adjacent to the marker. You can use it to decorate your walls / fence selectively. E.g. do no spawn lights on walls of an empty side, or have a different art style when a wall is shared by two rooms</p>
<h3 id="is-near-marker">Is Near Marker</h3>
<div class="figure">
<img src="../assets/images/query_grid_IsNearMarker.png" alt="Is Near Marker" />
<p class="caption">Is Near Marker</p>
</div>
<p>The function returns true if a marker with the specified name is found nearby. You specify the distance to search and the marker name.</p>
<p>This function is useful if you don’t want to place blocking items near doors / stairs.</p>
<p><img src="../assets/images/query_grid_near_marker_1.png" alt="Query System" /> <img src="../assets/images/query_grid_near_marker_2.png" alt="Query System" /></p>
<h1 id="spawn-logic">Spawn Logic</h1>
<p>Spawn Logics are blueprints that are attached to visual nodes and are executed whenever that visual item (mesh, actor, particle system, light etc) is spawned into the scene</p>
<p>These are great for initializing blueprints (or randomizing them). Some use cases include randomizing the colors of the lights that spawn from a light node, or you can use it to initialize your blueprints spawned from the actor nodes</p>
<p>You can attach a spawn logic to any visual node (e.g. mesh node, light node, particle system node, actor node etc)</p>
<p>Set the <em>Use Spawn Logic</em> flag and choose your spawn logic blueprint</p>
<div class="figure">
<img src="../assets/images/spawn_logic_detail.png" alt="Spawn Logic" />
<p class="caption">Spawn Logic</p>
</div>
<h2 id="create-spawn-logic">Create Spawn Logic</h2>
<div class="figure">
<img src="../assets/images/spawn_logic_create.png" alt="Spawn Logic" />
<p class="caption">Spawn Logic</p>
</div>
<p>Create a new blueprint class and pick DungeonSpawnLogic class as the parent</p>
<h2 id="define-spawn-logic">Define Spawn Logic</h2>
<p>Open your blueprint and override the <em>OnItemSpawn</em> function.</p>
<div class="figure">
<img src="../assets/images/spawn_logic_override.png" alt="Spawn Logic" />
<p class="caption">Spawn Logic</p>
</div>
<p>Get the reference of the spawn actor and cast it to the type you are expecting. Since this logic was attached to a mesh node, it is cast to a static mesh and customizations can be applied to it <img src="../assets/images/spawn_logic_override2.png" alt="Spawn Logic" /></p>
<p>Another blueprint that was attached to a point light. Since we expect a point light, we cast to the correct type and change the color <img src="../assets/images/spawn_logic_override3.png" alt="Spawn Logic" /></p>
<h1 id="event-listeners">Event Listeners</h1>
<p>Event listeners are blueprints that get notified on various dungeon events. These are great for pre / post initializations</p>
<h2 id="creation">Creation</h2>
<p>Create a Event listener blueprint by choosing <code>DungeonEventListener</code> as the base class <img src="../assets/images/event_listener_create.png" alt="Event Listener" /></p>
<p>Override any of the function events to get notified. This function will be called by Dungeon Architect if your blueprint is registered with the Dungeon actor <img src="../assets/images/event_listener_create2.png" alt="Event Listener" /></p>
<h2 id="registration">Registration</h2>
<p>You need to register this blueprint with the dungeon actor to get its event notifications</p>
<p>Select the Dungeon Actor and Navigate to the <code>Advanced</code> category in the Details tab and choose your blueprint class <img src="../assets/images/event_listener_create3.png" alt="Event Listener" /></p>
<h2 id="event-callbacks">Event Callbacks</h2>
<p>Your blueprint can hook into various events of the dungeon build / destroy phase</p>
<h3 id="on-pre-dungeon-build">On Pre Dungeon Build</h3>
<p>This is called before the dungeon is built</p>
<h3 id="on-dungeon-layout-built">On Dungeon Layout Built</h3>
<p>This is called after the dungeon layout is built in memory. At this stage, no markers are emitted on the scene and nothing is spawned. However, the layout is available in the dungeon model if you’d like to view or modify it</p>
<h3 id="on-markers-emitted">On Markers Emitted</h3>
<p>This event is called after all the markers are emitted in the scene. This event is also called right before the Theming engine is executed. So this event gives you an oppertunity to modify the low markers themselves</p>
<p>This could be useful for automatically clamping dungeon items on a landscape or to apply some filter on the markers like the one shown below (see quick start guide for an example)</p>
<div class="figure">
<img src="../assets/images/event_listener_filter.jpg" alt="Event Listener" />
<p class="caption">Event Listener</p>
</div>
<h3 id="on-post-dungeon-build">On Post Dungeon Build</h3>
<p>This is called after the dungeon is fully built</p>
<h3 id="on-pre-dungeon-destroy">On Pre Dungeon Destroy</h3>
<p>This is called right before the dungeon is about to be destroyed</p>
<h3 id="on-dungeon-destroyed">On Dungeon Destroyed</h3>
<p>This is called after the dungeon is fully destroyed</p>
<h1 id="landscape-transformer">Landscape Transformer</h1>
<p>Using the Landscape Transformer, you can modify a landscape’s height and weights (textures) around the dungeon’s layout</p>
<p>The landscape transformer is implemented as a event listener, so you’ll need to register it in the Dungeon actor’s event listener list under the Advanced category</p>
<div class="figure">
<img src="../assets/images/landscape_transformer.png" alt="Landscape Transformer" />
<p class="caption">Landscape Transformer</p>
</div>
<p>After setting the landscape transformer, expand it and set the Landscape you’d wish to modify</p>
<div class="figure">
<img src="../assets/images/landscape_transformer2.png" alt="Landscape Transformer" />
<p class="caption">Landscape Transformer</p>
</div>
<p>Under the Layers array, add two entries</p>
<p>The first entry should be the Layer Info for filling the entire area The second entry is for the inner path way.</p>
<p>You would have already created these layer info assets while creating the landscape and setting up the material</p>
<p>To find where you layer info is, Navigate to the Landscape tab &gt; Paint section. There you’d see entries for each layer that was defined in your material. If you didn’t create a layer info yet, create one or click the Find icon to find where it is. Then assign the appropriate layer</p>
<div class="figure">
<img src="../assets/images/landscape_transformer_layer.png" alt="Landscape Transformer" />
<p class="caption">Landscape Transformer</p>
</div>
<p><iframe width="853" height="480" src="https://www.youtube.com/embed/9MI9IzNytuY?rel=0&amp;showinfo=0" frameborder="0" allowfullscreen></iframe></p>
<h1 id="navigation">Navigation</h1>
<p>Unreal Engine supports runtime navigation generation. However, a flag needs to be set in the projects setting.</p>
<p>Navigate to <code>Edit &gt; Project Settings &gt; Navgation Mesh &gt; Runtime &gt; Dynamic</code></p>
<div class="figure">
<img src="../assets/images/navmesh_1.png" alt="Runtime Navigation Mesh Generation" />
<p class="caption">Runtime Navigation Mesh Generation</p>
</div>
<div class="figure">
<img src="../assets/images/navmesh_2.png" alt="Runtime Navigation Mesh Generation" />
<p class="caption">Runtime Navigation Mesh Generation</p>
</div>
<p>This will automatically regenerate the navigation on runtime generated dungeons. Be sure to have a <code>Nav Mesh bounds Volume</code> large enough to wrap the whole dungeon. There is an example in the quick start guide to automatically wrap the navigation volume around a dungeon after it has been built.</p>
<p><iframe width="853" height="480" src="https://www.youtube.com/embed/uowWAVwEiEc?rel=0&amp;showinfo=0" frameborder="0" allowfullscreen></iframe></p>
<h1 id="advanced">Advanced</h1>
<h2 id="using-multiple-dungeons">Using Multiple Dungeons</h2>
<p>You can setup multiple dungeons in your scene. A dungeon is generated relative to the position of the dungeon actor</p>
<h2 id="blend-with-existing-art">Blend with existing art</h2>
<p>Blend procedural dungeons with your existing level art by creating constraints using platform volumes so they make an entrace from your static artist designed levels to your dungeons</p>
<p><iframe width="853" height="480" src="https://www.youtube.com/embed/81W6Rhwmhfc?rel=0&amp;showinfo=0" frameborder="0" allowfullscreen></iframe></p>
<p>In the above video, the central area was created by the artist and doors leading to the left and right sides. After dropping two dungeons actors into the scene, they were forced to connect to these artist generated entrace using a platform volume and marker replacement volume (to force create a door)</p>
<div id="footer">
  &copy; 2015 <a href="http://coderespawn.com/">Code Respawn Technologies Pvt Ltd</a>
</div>

</div>

</div>
</body>
</html>
